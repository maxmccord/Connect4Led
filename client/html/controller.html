<html>
<head>
<title>Controller</title>
<script src="http://cdn.pubnub.com/pubnub-3.7.18.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
<script>

var app = angular.module('app', []);

app.controller('controller', function ($scope) {
   $scope.player = 0;

   pubnub = PUBNUB({
      publish_key   : 'pub-c-4421eb01-7fb7-44c1-8b5a-de3fd622eaba',
      subscribe_key : 'sub-c-9386a098-a106-11e5-bcd8-0619f8945a4f'
   });

   $scope.sendCommand = function (command) {
      pubnub.publish({
         channel : 'ledgame_player',
         message : {
            player:  $scope.player,
            command: command
         }
      });
   };

   // listen for messages from the server

   var processServerMessage = function (message, env, ch, timer, magic_ch) {
      console.log('Message received: ' + JSON.stringify(message));
   };

   pubnub.subscribe({
      channel : 'ledgame_server',
      message : processServerMessage,
      connect: function () {
         console.log('connected.');
      }
   });
});

</script>
</head>
<body>

<div ng-app="app", ng-controller="controller">

<h1>Controller</h1>

<input type="button" value="Left" ng-click="sendCommand(0)" />
<input type="button" value="Right" ng-click="sendCommand(1)" />

</div>

</body>
</html>
